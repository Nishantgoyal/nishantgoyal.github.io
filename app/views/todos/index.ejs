<%- include ("../partials/header.ejs") %>

<h1> TODOs </h1>

<% if(currentUser) { %>
  <form action="/todos" method="POST">
    <input type="text" name="item" placeholder="Add Todo">
    <input type="text" name="category" placeholder="Category">
    <select name="task_status">
      <option value="todo" default> Todo </option>
      <option value="in-progress"> in-progress </option>
      <option value="done"> done </option>
    </select>
    <select name="type">
      <option value="one-time" default> One Time </option>
      <option value="recurring"> Recurring </option>
    </select>
    <input type="submit" value="Create">
  </form>
<% } %>


<ul>
  <% todos.forEach(function(todo) { %>
    <li> 
      <% if(id && id === todo.id) { %>
        <form action="/todos/<%= todo.id %>?_method=PUT" method="POST">
          <input type="text" name="todo[item]" value="<%= todo.item %>">
          <input type="text" name="todo[category]" value="<%= todo.category %>">
          <select name="todo[task_status]">
            <option value="todo" default> Todo </option>
            <option value="in-progress" default> in-progress </option>
            <option value="done" default> done </option>
          </select>
          <select name="todo[type]">
            <option value="one-time" default> One Time </option>
            <option value="recurring"> Recurring </option>
          </select>
          <input type="submit" name="Update">
        </form>
      <% } else { %>
        <a href="/todos/<%= todo.id %>/edit">
          <%= todo.item %> - <%= todo.category %> 
        </a>
        <span> <%= todo.task_status %> - <%= todo.type %> </span> 
        <form class="inline-form" action="/todos/<%= todo.id %>?_method=DELETE" method="POST">
          <input type="submit" value="x">
        </form>
      <% } %>
    </li>
  <% }); %>
</ul>

<%- include ("../partials/footer.ejs") %>
